"use strict";function mapClick(){myApp.findCityList(),$showActivites.fadeIn(),setTimeout(function(){$(".map___section").fadeOut()},50)}function submitClick(){$results.fadeIn(),$(".section___results").show()}function worldMap(){$("#map").vectorMap({map:"continents_mill",focusOn:{scale:1.1,x:-1.2,y:-2},backgroundColor:"transparent",zoomOnScroll:!1,zoomButtons:!1,zoomAnimate:!1,regionsSelectable:!0,regionsSelectableOne:!0,panOnDrag:!1,regionStyle:{initial:{fill:"#a4def9","fill-opacity":1,stroke:"none","stroke-width":0,"stroke-opacity":1},hover:{"fill-opacity":.6,cursor:"pointer"},selected:{fill:"white"}},onRegionClick:function(e,i){var t=$("#map").vectorMap("get","mapObject");myApp.selectedRegion=t.getRegionName(i),console.log(myApp.selectedRegion),mapClick()}})}var myApp={};myApp.selectedRegion="",myApp.activitiesCities=[],myApp.endCities=[];var $results=$("#results"),$showActivites=$(".section___activity"),$loaderOne=$("#loaderOne"),$loderTwo=$("#loaderTwo"),activitySection=document.getElementById("section___activity");$("label").on("click",function(){$(this).toggleClass("teal")}),$("form").on("submit",function(e){e.preventDefault(),submitClick(),myApp.findCityWithactivities(myApp.activitiesCities),window.scrollTo(0,document.body.scrollHeight)}),myApp.findCityList=function(){$.ajax({url:"https://nomadlist.com/api/v2/list/cities",dataType:"json"}).then(function(e){$loaderOne.hide(),$("form").fadeIn(),$("#form___title").fadeIn(),activitySection.scrollIntoView();var i=e.result;myApp.findCityInRegion(i)})},myApp.findCityInRegion=function(e){var i=e.filter(function(e){return e.info.region.name===myApp.selectedRegion});console.log(i),myApp.activitiesCities.push(i)},myApp.findCityWithactivities=function(){var e=$("#hiking").is(":checked"),i=$("#history").is(":checked"),t=$("#outdoors").is(":checked"),n=$("#surfing").is(":checked"),s=$("#cycling").is(":checked"),o=$("#beach").is(":checked"),a=$("#temples").is(":checked"),c=$("#spa").is(":checked"),p=$("#golf").is(":checked"),l=(myApp.activitiesCities.filter(function(l){for(var r=0;r<l.length;r++)l[r].tags.includes("history")&&i&&myApp.endCities.push(l[r]),l[r].tags.includes("outdoors")&&t&&myApp.endCities.push(l[r]),l[r].tags.includes("surfing")&&n&&myApp.endCities.push(l[r]),l[r].tags.includes("cycling")&&s&&myApp.endCities.push(l[r]),l[r].tags.includes("beach")&&o&&myApp.endCities.push(l[r]),l[r].tags.includes("temples")&&a&&myApp.endCities.push(l[r]),l[r].tags.includes("spa")&&c&&myApp.endCities.push(l[r]),l[r].tags.includes("hiking")&&e&&myApp.endCities.push(l[r]),l[r].tags.includes("golf")&&p&&myApp.endCities.push(l[r]),i||t||e||n||s||o||c||a||p||myApp.endCities.push(l[r]);return myApp.endCities}),_.uniq(myApp.endCities));myApp.displayCities(l)},myApp.displayCities=function(e){e.forEach(function(e){var i=250*e.scores.leisure,t=250*e.scores.nightlife,n=250*e.scores.safety,s=$("#results"),o=$('<figure class="figure___city">'),a=$('<div class="cityHeader">').css("background-image","linear-gradient(rgba(0, 0, 0, 0.5),rgba(0, 0, 0, 0.5)),url(https://nomadlist.com"+e.media.image[250]+")"),c=$("<h3 class='city___name'>").text(e.info.city.name),p=$("<h4 class='country___name'>").text(e.info.country.name),l=$('<p class="paragraph___top">').text("Leisure Rating"),r=$('<div class="progress '+(75>i?"red ":"green ")+(175>i&&i>75?"yellow ":"green ")+'">').width(i),d=$("<p>").text("Nightlife Rating"),m=$('<div class="progress '+(75>t?"red ":"green ")+(175>t&&t>75?"yellow ":"green ")+'">').width(t),u=$("<p>").text("Safety Rating"),y=$('<div class="progress '+(75>n?"red ":"green ")+(175>n&&n>75?"yellow ":"green ")+'">').width(n),h=$("<p>").text("Airbnb average one night stay: $"+e.cost.airbnb_median.USD),f=$('<a href="" class="view___pix swipebox">').text("Photos"),g=$('<a href="https://www.airbnb.ca/s/'+e.info.city.name+'" target="_blank">').text("Air Bnb");a.append(c,p),o.append(a,l,r,d,m,u,y,h,f,g),s.flickity({pageDots:!1,initialIndex:5,contain:!0}),s.flickity("append",o);var _=document.getElementById("results");_.scrollIntoView()})},$(".section___results").on("click",".view___pix",function(e){e.preventDefault();var i=$(this).siblings(".cityHeader").children(".city___name").text(),t=$(this).siblings(".cityHeader").children(".country___name").text();console.log(t),myApp.getPhotos(i)}),myApp.getPhotos=function(e){$.ajax({url:"https://pixabay.com/api/",dataType:"JSON",data:{key:"3551643-fa4c0e3a2956d8c2df20a82df",category:"travel",image_type:"photo",q:e}}).then(function(e){$("#loaderTwo").hide(),console.log(e),myApp.displayPhotos(e)})},myApp.displayPhotos=function(e){var i=e.hits;if(i.length>0){var t=i.map(function(e){return{href:e.webformatURL}});$.swipebox(t)}else alert("No pictures found, sorry!")},$(function(){$('a[href*="#"]:not([href="#"])').click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var e=$(this.hash);if(e=e.length?e:$("[name="+this.hash.slice(1)+"]"),e.length)return $("html, body").animate({scrollTop:e.offset().top},1e3),!1}})}),myApp.init=function(){$("header").vide("videos/bgvid"),worldMap(),console.log("init")},$(document).ready(function(){myApp.init()});
